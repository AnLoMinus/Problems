{% extends "base.html" %}

{% block content %}
<div class="calendar-container">
    <div class="calendar-header">
        <div class="calendar-nav">
            <a href="{{ url_for('calendar_view', year=year, month=month-1 if month > 1 else 12) }}"
                class="btn btn-outline-primary">
                <i class="fas fa-chevron-right"></i>
            </a>
            <h2>{{ month_name }} {{ year }}</h2>
            <a href="{{ url_for('calendar_view', year=year, month=month+1 if month < 12 else 1) }}"
                class="btn btn-outline-primary">
                <i class="fas fa-chevron-left"></i>
            </a>
        </div>
    </div>

    <div class="calendar-grid">
        <div class="calendar-weekdays">
            <div>ראשון</div>
            <div>שני</div>
            <div>שלישי</div>
            <div>רביעי</div>
            <div>חמישי</div>
            <div>שישי</div>
            <div>שבת</div>
        </div>

        {% for week in calendar %}
        <div class="calendar-week">
            {% for day in week %}
            <div class="calendar-day {{ 'empty' if day == 0 else '' }} {{ 'has-problems' if day in problem_dates }}">
                {% if day != 0 %}
                <div class="day-number">{{ day }}</div>
                {% if day in problem_dates %}
                <div class="day-problems">
                    {% for problem in problem_dates[day] %}
                    <div class="calendar-problem" data-bs-toggle="tooltip" title="{{ problem.title }}">
                        <span class="badge bg-{{ 'success' if problem.status == 'closed' else 'warning' }}">
                            {{ problem.title[:20] + '...' if problem.title|length > 20 else problem.title }}
                        </span>
                    </div>
                    {% endfor %}
                </div>
                {% endif %}
                {% endif %}
            </div>
            {% endfor %}
        </div>
        {% endfor %}
    </div>
</div>
{% endblock %}